var Services;!function(a){var b=function(){function a(a,b){this.$http=a,this.$q=b}return a.$inject=["$http","$q"],a.prototype.getRecentlyRated=function(){var a=this,b=this.$q.defer();return this.$http.get("/hotels/recentlyRated").success(function(c){b.resolve(a.averageRatings(c))}).error(function(a,c){b.reject("Error "+c)}),b.promise},a.prototype.find=function(a){var b=this.$q.defer();return this.$http.get("/hotel/"+a).success(function(a){b.resolve(a)}).error(function(a,c){404===c&&b.reject("Hotel not found"),b.reject("Error "+c)}),b.promise},a.prototype.search=function(a){var b=this,c=this.$q.defer();return this.$http.get("/hotels",{params:{query:a}}).success(function(a){c.resolve(b.averageRatings(a))}).error(function(a,b){c.reject("Error "+b)}),c.promise},a.prototype.averageRatings=function(a){return a.forEach(function(a){a.averageQuality=(a.ratings||[]).map(function(a){return a.quality}).average()}),a},a}();a.HotelService=b}(Services||(Services={}));var HomeController=function(){function a(a,b){this.$http=a,this.$window=b;var c=this;a.get("/hotels/recentlyRated").success(function(a){c.hotels=c.averageRatings(a)})}return a.$inject=["$http","$window"],a.prototype.search=function(){var a=this;this.$http.get("/hotels",{params:{query:this.query}}).success(function(b){a.searchResults=a.averageRatings(b)}).error(function(){})},a.prototype.averageRatings=function(a){return a.forEach(function(a){a.averageQuality=(a.ratings||[]).map(function(a){return a.quality}).average()}),a},a}(),HotelController=function(){function a(a,b,c){this.hotelService=a,this.$routeParams=b,this.$window=c;var d=this;a.find(b.id).then(function(a){d.hotel=a},function(a){c.alert(a)})}return a.$inject=["hotelService","$routeParams","$window"],a}(),Utils;!function(a){function b(a,b){var c;return"string"==typeof b&&(c=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)\+00:00$/.exec(b))?new Date(Date.UTC(+c[1],+c[2]-1,+c[3],+c[4],+c[5],+c[6])):b}function c(a){return angular.isString(a)&&(a=a.replace(f,""),d.test(a)&&e.test(a)&&(a=JSON.parse(a,b))),a}var d=/^\s*(\[|\{[^\{])/,e=/[\}\]]\s*$/,f=/^\)\]\}',?\n/;a.transformResponse=c}(Utils||(Utils={})),angular.module("bandb",["ui.bootstrap"]).config(["$routeProvider","$httpProvider",function(a,b){a.when("/hotel/:id",{templateUrl:"html/hotel.html",controller:HotelController,controllerAs:"dc"}).when("/",{templateUrl:"html/home.html",controller:HomeController,controllerAs:"dc"}),b.defaults.transformResponse=Utils.transformResponse}]).service("hotelService",Services.HotelService);